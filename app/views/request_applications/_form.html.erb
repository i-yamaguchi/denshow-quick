<%= form_for(@request_application) do |f| %>
  <% if @request_application.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@request_application.errors.count, "error") %> prohibited this request_application from being saved:</h2>

      <ul>
      <% @request_application.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="row">
    <div class="well well-sm">
      <div class="form-group">
        <div class="row">
          <div class="col-lg-2">
            <%= f.label :management_no %><br>
            <%= f.text_field :management_no %>
          </div>
          <div class="col-lg-2">
            <%= f.label :project_id %><br>
            <%= f.collection_select :project_id, Dept.projects, :id, :name  %>
          </div>
          <div class="col-lg-2">
            <%= f.label :model_id %><br>
            <%= f.collection_select :model_id, Model.all, :id, :name  %>
          </div>
          <div class="col-lg-2">
            <%= f.label :section_id %><br>
            <%= f.collection_select :section_id, Section.all, :id, :name  %>
          </div>
          <div class="col-lg-4">
            <%= f.label :emargency %><br>
            <%= f.check_box :emargency %>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-3">
            <%= f.label :filename %><br>
            <%= f.file_field :filename %>
          </div>
          <div class="col-lg-3">
            <%= f.label :request_date %><br>
            <%= f.date_select :request_date %>
          </div>
          <div class="col-lg-3">
            <%= f.label :preferred_date %><br>
            <%= f.date_select :preferred_date %>
          </div>
          <div class="col-lg-3">
            <%= f.label :memo %><br>
            <%= f.text_area :memo %>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th><%= label_tag :doc_no %></th>
            <th><%= label_tag :doc_type %></th>
            <th><%= label_tag :sht %></th>
            <th><%= label_tag :rev%></th>
            <th><%= label_tag :eo_chgno %></th>
            <th><%= label_tag :chg_type %></th>
            <th><%= label_tag :mcl %></th>
            <th><%= label_tag :scp_for_smpl %></th>
            <th><%= label_tag :scml_ln %></th>
          </tr>
        </thead>
        <tbody>
          <% @request_application.details.all.each do |detail| %>
            <tr>
              <td><%= detail.doc_no %></td>
              <td><%= detail.doc_type %></td>
              <td><%= detail.sht %></td>
              <td><%= detail.rev %></td>
              <td><%= detail.eo_chgno %></td>
              <td><%= detail.chg_type %></td>
              <td><%= detail.mcl %></td>
              <td><%= detail.scp_for_smpl %></td>
              <td><%= detail.scml_ln%></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
  <div class="row">
    <div class="panel panel-default">
      <div class="panel-heading">New Request Application Detail</div>
      <div class="panel-body">
        <%= f.fields_for :details do |detail| %>
          <% next if detail.object.id.present? %>
          <div class="row">
            <div class="col-lg-2">
              <%= detail.label :doc_no %>
              <%= detail.text_field :doc_no %>
            </div>
            <div class="col-lg-2">
              <%= detail.label :doc_type %>
              <%= detail.text_field :doc_type %>
            </div>
            <div class="col-lg-2">
              <%= detail.label :sht %>
              <%= detail.text_field :sht %>
            </div>
            <div class="col-lg-2">
              <%= detail.label :rev %>
              <%= detail.text_field :rev %>
            </div>
            <div class="col-lg-2">
              <%= detail.label :eo_chgno %>
              <%= detail.text_field :eo_chgno %>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-2">
              <%= detail.label :chg_type %>
              <%= detail.text_field :chg_type %>
            </div>
            <div class="col-lg-2">
              <%= detail.label :mcl %>
              <%= detail.text_field :mcl %>
            </div>
            <div class="col-lg-2">
              <%= detail.label :scp_for_smpl %>
              <%= detail.text_field :scp_for_smpl %>
            </div>
            <div class="col-lg-2">
              <%= detail.label :scml_ln %>
              <%= detail.text_field :scml_ln %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="actions">
      <%= f.submit 'Save and Insert', class:"btn btn-primary", data: { action: 'save_and_insert'} %>
      <%= f.submit 'Save and End Regist', class:"btn btn-primary", data: { action: 'end_regist'} %>
    </div>
  </div>
<% end %>
