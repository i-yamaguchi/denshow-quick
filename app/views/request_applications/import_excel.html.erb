<div class="row">
  <h1><%= t('.title') %></h1>
</div>

<% if @request_application.errors.any? %>
  <div id="error_explanation">
    <h2><%= t('activerecord.errors.template.header', count: @request_application.errors.messages.length) %></h2>
    <ul>
    <% @request_application.errors.full_messages.each do |message| %>
      <li><%= message %></li>
    <% end %>
    </ul>
  </div>
<% end %>

<div class="row">
  <div class="panel panel-default">
    <div class="panel-heading">
      <%= t('activerecord.models.request_application') %>
    </div>
    <div class="panel-body">
      <table class="table table-bordered table-hover">
        <colgroup>
          <col class="col-lg-2" />
          <col class="col-lg-10" />
        </colgroup>
        <tbody>
          <tr>
            <td><%= label_tag :management_no, t('activerecord.attributes.request_application.management_no') %></td>
            <td class="<%= append_error_class(@request_application, :management_no) %>">
              <%= @request_application.management_no %>
            </td>
          </tr>
          <tr>
            <td><%= label_tag :section, t('activerecord.attributes.request_application.section') %></td>
            <td class="<%= append_error_class(@request_application, :section) %>">
              <%= @request_application.section&.name %>
            </td>
          </tr>
          <tr>
            <td><%= label_tag :request_date, t('activerecord.attributes.request_application.request_date') %></td>
            <td class="<%= append_error_class(@request_application, :request_date) %>">
              <%= @request_application.request_date %>
            </td>
          </tr>
          <tr>
            <td><%= label_tag :preferred_date, t('activerecord.attributes.request_application.preferred_date') %></td>
            <td class="<%= append_error_class(@request_application, :preferred_date) %>">
              <%= @request_application.preferred_date %>
            </td>
          </tr>
          <tr>
            <td><%= label_tag :model, t('activerecord.attributes.request_application.model') %></td>
            <td class="<%= append_error_class(@request_application, :model) %>">
              <%= @request_application.model&.code %>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="row">
  <div class="panel panel-default">
    <div class="panel-heading">
      <%= t('activerecord.models.request_detail') %>
    </div>
    <div class="panel-body">
      <table class="table table-bordered table-hover">
        <thead>
          <tr>
            <th><%= label_tag 'No.' %></th>
            <th><%= label_tag :doc_no, t('activerecord.attributes.request_detail.doc_no') %></th>
            <th><%= label_tag :doc_type, t('activerecord.attributes.request_detail.doc_type') %></th>
            <th><%= label_tag :sht, t('activerecord.attributes.request_detail.sht') %></th>
            <th><%= label_tag :rev, t('activerecord.attributes.request_detail.rev') %></th>
            <th><%= label_tag :eo_chgno, t('activerecord.attributes.request_detail.eo_chgno') %></th>
            <th><%= label_tag :chg_type, t('activerecord.attributes.request_detail.chg_type') %></th>
            <th><%= label_tag :mcl, t('activerecord.attributes.request_detail.mcl') %></th>
            <th><%= label_tag :scp_for_smpl, t('activerecord.attributes.request_detail.scp_for_smpl') %></th>
            <th><%= label_tag :scml_ln, t('activerecord.attributes.request_detail.scml_ln') %></th>
            <th><%= label_tag :vendor_code, t('activerecord.attributes.request_detail.vendor_code') %></th>
          </tr>
        </thead>
        <% if @request_application.details.present? %>
          <tbody>
            <% @request_application.details.each_with_index do |detail, i| %>
              <tr class="<%= 'error-border' if detail.errors.any? %>" >
                <td><%= i + 1 %></td>
                <td class="<%= append_error_class(detail, :doc_no) %>">
                  <%= detail.doc_no %>
                </td>
                <td class="<%= append_error_class(detail, :doc_type_id) %>">
                  <%= detail.doc_type&.name %>
                </td>
                <td class="<%= append_error_class(detail, :sht) %>">
                  <%= detail.sht %>
                </td>
                <td class="<%= append_error_class(detail, :rev) %>">
                  <%= detail.rev %>
                </td>
                <td class="<%= append_error_class(detail, :eo_chgno) %>">
                  <%= detail.eo_chgno %>
                </td>
                <td class="<%= append_error_class(detail, :chg_type_id) %>">
                  <%= detail.chg_type&.name %>
                </td>
                <td class="<%= append_error_class(detail, :mcl) %>">
                  <%= detail.mcl %>
                </td>
                <td class="<%= append_error_class(detail, :scp_for_smpl) %>">
                  <%= detail.scp_for_smpl %>
                </td>
                <td class="<%= append_error_class(detail, :scml_ln) %>">
                  <%= detail.scml_ln %>
                </td>
                <td class="<%= append_error_class(detail, :vendor_code) %>">
                  <%= detail.vendor_code %>
                </td>
              </tr>
            <% end %>
          </tbody>
        <% end %>
      </table>
    </div>
  </div>
</div>
<div class="row">
  <%= link_to t('.back'), request_applications_path, class: 'btn btn-primary' %>
</div>
